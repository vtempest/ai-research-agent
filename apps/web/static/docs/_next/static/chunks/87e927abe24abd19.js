(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,57659,e=>{"use strict";var t=e.i(44065),i=e.i(36520),r=e.i(24158),a=e.i(93158),l=e.i(88722),n=e.i(76876);e.i(68150);var s=e.i(27588),o=e.i(34871),c=e.i(47005);let d={password:{name:"Resource Owner Password Flow",description:"Authenticate using username and password."},clientCredentials:{name:"Client Credentials",description:"Intended for the server-to-server authentication."},authorizationCode:{name:"Authorization code",description:"Authenticate with 3rd party services"},implicit:{name:"Implicit",description:"Retrieve the access token directly."}};function u({scheme:e,scopes:u,setToken:h,children:p,open:m,setOpen:w}){let[f,x]=(0,n.useState)(()=>Object.keys(e.flows)[0]),g=(0,r.useForm)({defaultValues:{clientId:"",clientSecret:"",username:"",password:""}}),j=(0,l.useQuery)(async(t,i)=>{let r=e.flows.authorizationCode,a=await fetch(r.tokenUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"authorization_code",code:t,redirect_uri:i.redirect_uri,client_id:i.client_id,client_secret:i.client_secret})});if(!a.ok)throw Error(await a.text());let{access_token:l,token_type:n="Bearer"}=await a.json();h(`${n} ${l}`),w(!1)});(0,n.useEffect)(()=>{if(e.flows.authorizationCode){let e=new URLSearchParams(window.location.search),t=e.get("state"),i=e.get("code");if(t&&i){let e=JSON.parse(t);w(!0),g.setValue("clientId",e.client_id),g.setValue("clientSecret",e.client_secret),j.start(i,e),window.history.replaceState(null,"",window.location.pathname);return}}if(e.flows.implicit&&window.location.hash.length>1){let e=new URLSearchParams(window.location.hash.slice(1)),t=e.get("state"),i=e.get("access_token"),r=e.get("token_type")??"Bearer";if(t&&i){let e=JSON.parse(t);g.setValue("clientId",e.client_id),h(`${r} ${i}`),window.history.replaceState(null,"",window.location.pathname)}}},[]);let S=(0,l.useQuery)(async t=>{let i;if("implicit"===f){let i=e.flows[f],r=new URLSearchParams;r.set("response_type","token"),r.set("client_id",t.clientId),r.set("redirect_uri",window.location.href),r.set("scope",u.join("+")),r.set("state",JSON.stringify({client_id:t.clientId,redirect_uri:window.location.href})),window.location.replace(`${i.authorizationUrl}?${r.toString()}`);return}if("authorizationCode"===f){let i=e.flows[f],r=new URLSearchParams;r.set("response_type","code"),r.set("client_id",t.clientId),r.set("redirect_uri",window.location.href),r.set("scope",u.join("+")),r.set("state",JSON.stringify({client_id:t.clientId,client_secret:t.clientSecret,redirect_uri:window.location.href})),window.location.replace(`${i.authorizationUrl}?${r.toString()}`);return}if("password"===f){let r=e.flows[f];i=await fetch(r.tokenUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"password",username:t.username,password:t.password,scope:u.join("+")})})}if("clientCredentials"===f){let r=e.flows[f];i=await fetch(r.tokenUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"client_credentials",client_id:t.clientId,client_secret:t.clientSecret,scope:u.join("+")})})}if(i){if(!i.ok)throw Error(await i.text());let{access_token:e,token_type:t="Bearer"}=await i.json();h(`${t} ${e}`),w(!1)}}),y=g.handleSubmit(e=>S.start(e)),_=S.isLoading||j.isLoading,b=j.error??S.error;return(0,t.jsxs)(i.Dialog,{open:m,onOpenChange:w,children:[p,(0,t.jsxs)(i.DialogContent,{children:[(0,t.jsxs)(i.DialogHeader,{children:[(0,t.jsx)(i.DialogTitle,{children:"Authorization"}),(0,t.jsx)(i.DialogDescription,{children:"Obtain the access token for API."})]}),(0,t.jsxs)("form",{className:"flex flex-col gap-6",onSubmit:e=>{y(e),e.stopPropagation()},children:[(0,t.jsxs)(c.Select,{value:f,onValueChange:x,children:[(0,t.jsx)(c.SelectTrigger,{children:(0,t.jsx)(c.SelectValue,{})}),(0,t.jsx)(c.SelectContent,{children:Object.keys(e.flows).map(e=>{let{name:i,description:r}=d[e];return(0,t.jsxs)(c.SelectItem,{value:e,children:[(0,t.jsx)("p",{className:"font-medium",children:i}),(0,t.jsx)("p",{className:"text-fd-muted-foreground",children:r})]},e)})})]}),("authorizationCode"===f||"clientCredentials"===f||"implicit"===f)&&(0,t.jsxs)("fieldset",{className:"flex flex-col gap-1.5",children:[(0,t.jsx)("label",{htmlFor:"client_id",className:(0,s.cn)((0,a.labelVariants)()),children:"Client ID"}),(0,t.jsx)("p",{className:"text-fd-muted-foreground text-sm",children:"The client ID of your OAuth application."}),(0,t.jsx)(a.Input,{id:"client_id",placeholder:"Enter value",type:"text",autoComplete:"off",disabled:_,...g.register("clientId",{required:!0})})]}),("authorizationCode"===f||"clientCredentials"===f)&&(0,t.jsxs)("fieldset",{className:"flex flex-col gap-1.5",children:[(0,t.jsx)("label",{htmlFor:"client_secret",className:(0,s.cn)((0,a.labelVariants)()),children:"Client Secret"}),(0,t.jsx)("p",{className:"text-fd-muted-foreground text-sm",children:"The client secret of your OAuth application."}),(0,t.jsx)(a.Input,{id:"client_secret",placeholder:"Enter value",type:"password",autoComplete:"off",disabled:_,...g.register("clientSecret",{required:!0})})]}),"password"===f&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("fieldset",{className:"flex flex-col gap-1.5",children:[(0,t.jsx)("label",{htmlFor:"username",className:(0,s.cn)((0,a.labelVariants)()),children:"Username"}),(0,t.jsx)(a.Input,{id:"username",placeholder:"Enter value",type:"text",disabled:_,autoComplete:"off",...g.register("username",{required:!0})})]}),(0,t.jsxs)("fieldset",{className:"flex flex-col gap-1.5",children:[(0,t.jsx)("label",{htmlFor:"password",className:(0,s.cn)((0,a.labelVariants)()),children:"Client Secret"}),(0,t.jsx)(a.Input,{id:"password",placeholder:"Enter value",type:"password",autoComplete:"off",disabled:_,...g.register("password",{required:!0})})]})]}),b?(0,t.jsx)("p",{className:"text-red-400 font-medium text-sm",children:String(b)}):null,(0,t.jsx)("button",{type:"submit",disabled:_,className:(0,s.cn)((0,o.buttonVariants)({color:"primary"})),children:j.isLoading?"Fetching token...":"Submit"})]})]})]})}let h=i.DialogTrigger;e.s(["OauthDialog",()=>u,"OauthDialogTrigger",0,h])}]);