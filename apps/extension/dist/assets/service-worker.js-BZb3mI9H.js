import{s as d}from"./search-engines-oLmTS5w1.js";function s(e,t,r){chrome.runtime.sendMessage({type:"updateTabLists",updateType:e,tabId:t,changeInfo:r})}chrome.tabs.onUpdated.addListener((e,t,r)=>{(t.status==="complete"||t.title)&&s("updated",e,{url:r.url,title:r.title})});chrome.tabs.onCreated.addListener(e=>{s("created",e.id,{url:e.url,title:e.title})});chrome.tabs.onRemoved.addListener((e,t)=>{s("removed",e,{})});chrome.tabs.onActivated.addListener(e=>{chrome.tabs.get(e.tabId,t=>{s("activated",t.id,{url:t.url,title:t.title})})});chrome.tabs.onUpdated.addListener(async(e,t,r)=>{await chrome.sidePanel.setOptions({tabId:e,path:"src/pages/sidepanel/index.html",enabled:!0}),s("updated",e,{url:r.url,title:r.title})});chrome.contextMenus.removeAll(function(){chrome.contextMenus.create({title:"Search With...",id:"searchWithParent",contexts:["selection"]});for(var e in d)chrome.contextMenus.create({title:` ${d[e].name}`,parentId:"searchWithParent",id:"searchWith"+e,contexts:["selection"]});chrome.contextMenus.create({title:"Reading Mode",id:"readingMode",contexts:["page","frame","image","link","video","audio"]})});chrome.contextMenus.onClicked.addListener((e,t)=>{const{menuItemId:r,selectionText:a}=e;if(r.startsWith("searchWith")){const n=r.replace("searchWith",""),o=d[n].url+encodeURIComponent(a);chrome.tabs.create({url:o,active:!1},i=>{setTimeout(()=>{chrome.tabs.update(i.id,{active:!0},l=>{chrome.runtime.lastError&&console.error("Error updating tab:",chrome.runtime.lastError)})},1500)})}else r==="readingMode"&&chrome.tabs.query({active:!0,currentWindow:!0},function(n){let o=n[0];o&&chrome.tabs.sendMessage(o.id,{action:"activateReadingMode"})})});const u=["qwksearch.com","debate-ai.com"];chrome.runtime.onInstalled.addListener(()=>{m(u)});function m(e="*://*/*",t="*"){var r;return(r=chrome==null?void 0:chrome.declarativeNetRequest)==null?void 0:r.updateDynamicRules({removeRuleIds:[1],addRules:[{id:1,priority:1,action:{type:"modifyHeaders",responseHeaders:[{header:"Access-Control-Allow-Origin",operation:"set",value:"*"},{header:"Access-Control-Allow-Methods",operation:"set",value:"GET, POST, OPTIONS, PUT, DELETE, PATCH"}]},condition:{urlFilter:t,initiatorDomains:e,resourceTypes:["main_frame","sub_frame","stylesheet","script","image","font","object","xmlhttprequest","ping","csp_report","media","websocket","other"]}}]})}chrome.runtime.onMessage.addListener(function(e,t,r){var{type:a,url:n}=e;return a==="openTab"&&chrome.tabs.create({url:n,active:!e.bg,selected:!e.bg}),a==="updateTabOrder"&&p(e.newOrder),a==="openDebateApp"&&chrome.runtime.openOptionsPage(),a==="requestFullScreen"&&chrome.tabs.query({active:!0,currentWindow:!0},function(o){let i=o[0];i&&chrome.scripting.executeScript({target:{tabId:i.id},function:h},()=>{chrome.sidePanel.open({windowId:i.windowId}).then(()=>{chrome.sidePanel.setOptions({enabled:!0,path:"sidepanel.html",mobile:!0,active:!0})})})}),!0});function h(){document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen().then(()=>{chrome.runtime.sendMessage({type:"fullScreenDeactivated"})}):document.documentElement.requestFullscreen().then(()=>{chrome.runtime.sendMessage({type:"fullScreenActivated"})}).catch(e=>{console.error(`Error attempting to enable full-screen mode: ${e.message} (${e.name})`)})}chrome.sidePanel.setPanelBehavior({openPanelOnActionClick:!0}).catch(e=>console.error(e));function c(e,t,r){chrome.runtime.sendMessage({type:"updateTabLists",updateType:e,tabId:t,changeInfo:r})}chrome.tabs.onUpdated.addListener((e,t,r)=>{(t.status==="complete"||t.title)&&c("updated",e,{url:r.url,title:r.title})});chrome.tabs.onCreated.addListener(e=>{c("created",e.id,{url:e.url,title:e.title})});chrome.tabs.onRemoved.addListener((e,t)=>{c("removed",e,{})});chrome.tabs.onActivated.addListener(e=>{chrome.tabs.get(e.tabId,t=>{c("activated",t.id,{url:t.url,title:t.title})})});chrome.tabs.onUpdated.addListener(async(e,t,r)=>{await chrome.sidePanel.setOptions({tabId:e,path:"src/pages/sidepanel/index.html",enabled:!0}),c("updated",e,{url:r.url,title:r.title})});function p(e){console.log("Updating tab order:",e),chrome.windows.getCurrent({populate:!0},function(t){const r=t.tabs,a=new Map(r.map((n,o)=>[n.id,o]));e.forEach((n,o)=>{const i=a.get(parseInt(n));i!==void 0&&i!==o&&chrome.tabs.move(parseInt(n),{index:o},l=>{chrome.runtime.lastError?console.error(`Error moving tab ${n}: ${chrome.runtime.lastError.message}`):console.log(`Moved tab ${n} to index ${o}`)})}),setTimeout(()=>{console.log("Tab reordering complete"),chrome.runtime.sendMessage({type:"tabReorderComplete"})},500)})}
