"use strict";(self.webpackChunkopenapi_docusaurus=self.webpackChunkopenapi_docusaurus||[]).push([["9156"],{74988:function(e,t,n){n.r(t),n.d(t,{default:()=>h,frontMatter:()=>s,metadata:()=>r,assets:()=>o,toc:()=>l,contentTitle:()=>a});var r=JSON.parse('{"id":"functions/extractor/html-to-content/extract-content/extract-content-mercury","title":"extract-content-mercury","description":"ai-research-agent / extractor/html-to-content/extract-content/extract-content-mercury","source":"@site/docs/functions/extractor/html-to-content/extract-content/extract-content-mercury.md","sourceDirName":"functions/extractor/html-to-content/extract-content","slug":"/functions/extractor/html-to-content/extract-content/extract-content-mercury","permalink":"/docs/functions/extractor/html-to-content/extract-content/extract-content-mercury","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"functions","previous":{"title":"extract-content-mercury-utils","permalink":"/docs/functions/extractor/html-to-content/extract-content/extract-content-mercury-utils"},"next":{"title":"extract-content-readability","permalink":"/docs/functions/extractor/html-to-content/extract-content/extract-content-readability"}}'),c=n("85893"),i=n("50065");let s={},a=void 0,o={},l=[{value:"Extract",id:"extract",level:2},{value:"extractMainContentFromHTML2()",id:"extractmaincontentfromhtml2",level:3},{value:"HTML-to-Main-Content Extractor #2",id:"html-to-main-content-extractor-2",level:3},{value:"Parameters",id:"parameters",level:4},{value:"Returns",id:"returns",level:4},{value:"Author",id:"author",level:4},{value:"Example",id:"example",level:4}];function d(e){let t={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(t.p,{children:[(0,c.jsx)(t.a,{href:"/docs/functions/",children:"ai-research-agent"})," / extractor/html-to-content/extract-content/extract-content-mercury"]}),"\n",(0,c.jsx)(t.h2,{id:"extract",children:"Extract"}),"\n",(0,c.jsx)(t.h3,{id:"extractmaincontentfromhtml2",children:"extractMainContentFromHTML2()"}),"\n",(0,c.jsx)(t.pre,{children:(0,c.jsx)(t.code,{className:"language-ts",children:"function extractMainContentFromHTML2(html, opts?): string\n"})}),"\n",(0,c.jsx)(t.h3,{id:"html-to-main-content-extractor-2",children:"HTML-to-Main-Content Extractor #2"}),"\n",(0,c.jsxs)(t.ol,{children:["\n",(0,c.jsx)(t.li,{children:"The algorithm starts by loading the HTML content using linkedom, a lightweight DOM parser for Node.js."}),"\n",(0,c.jsx)(t.li,{children:'It then applies a series of cleaning and scoring techniques to identify the main content of\nthe page, starting with stripping unlikely candidates (e.g., elements with class names like "comment"\nor "sidebar").'}),"\n",(0,c.jsx)(t.li,{children:"The HTML is converted into a series of paragraph elements, which are then scored based on various\nfactors such as text length, number of commas, and the presence of certain class names or IDs."}),"\n",(0,c.jsx)(t.li,{children:"The algorithm assigns scores to parent and grandparent elements based on the scores of their\nchildren, with parents receiving the full score and grandparents receiving half."}),"\n",(0,c.jsx)(t.li,{children:"After scoring, the algorithm finds the top candidate element by selecting the node with the\nhighest score."}),"\n",(0,c.jsx)(t.li,{children:"The top candidate's siblings are then examined to see if they should be included in the main\ncontent, based on their scores and other factors like link density."}),"\n",(0,c.jsx)(t.li,{children:"The algorithm then cleans the selected content by removing unnecessary tags, attributes, and empty\nelements."}),"\n",(0,c.jsx)(t.li,{children:"It also handles special cases like cleaning up header tags, images, and other potentially irrelevant\ncontent."}),"\n",(0,c.jsx)(t.li,{children:"Throughout the process, the algorithm uses various regular expressions and scoring heuristics to\nidentify positive and negative indicators of content relevance."}),"\n",(0,c.jsx)(t.li,{children:"Finally, the cleaned and extracted content is returned as an HTML string, representing the main\nbody of the article or webpage."}),"\n"]}),"\n",(0,c.jsx)(t.p,{children:(0,c.jsx)(t.a,{href:"https://trafilatura.readthedocs.io/en/latest/evaluation.html",children:"Article Extraction Benchmark"})}),"\n",(0,c.jsx)(t.h4,{id:"parameters",children:"Parameters"}),"\n",(0,c.jsxs)("table",{children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{children:"Parameter"}),(0,c.jsx)("th",{children:"Type"}),(0,c.jsx)("th",{children:"Description"})]})}),(0,c.jsxs)("tbody",{children:[(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:(0,c.jsx)(t.p,{children:(0,c.jsx)(t.code,{children:"html"})})}),(0,c.jsx)("td",{children:(0,c.jsx)(t.p,{children:(0,c.jsx)(t.code,{children:"string"})})}),(0,c.jsx)("td",{children:(0,c.jsx)(t.p,{children:"The HTML content to extract from."})})]}),(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:(0,c.jsxs)(t.p,{children:[(0,c.jsx)(t.code,{children:"opts"}),"?"]})}),(0,c.jsx)("td",{children:(0,c.jsxs)(t.p,{children:["{ ",(0,c.jsx)(t.code,{children:"cleanConditionally"}),": ",(0,c.jsx)(t.code,{children:"boolean"}),"; ",(0,c.jsx)(t.code,{children:"stripUnlikelyCandidates"}),": ",(0,c.jsx)(t.code,{children:"boolean"}),"; ",(0,c.jsx)(t.code,{children:"weightNodes"}),": ",(0,c.jsx)(t.code,{children:"boolean"}),"; }"]})}),(0,c.jsx)("td",{children:(0,c.jsx)(t.p,{children:"The options for content extraction."})})]}),(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:(0,c.jsxs)(t.p,{children:[(0,c.jsx)(t.code,{children:"opts.cleanConditionally"}),"?"]})}),(0,c.jsx)("td",{children:(0,c.jsx)(t.p,{children:(0,c.jsx)(t.code,{children:"boolean"})})}),(0,c.jsx)("td",{children:(0,c.jsx)(t.p,{children:"default=true - Clean the node to remove superfluous content\nlike forms, ads, etc. Initially, pass in the most restrictive options which will return the highest\nquality content. On each failure, retry with slightly more lax options."})})]}),(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:(0,c.jsxs)(t.p,{children:[(0,c.jsx)(t.code,{children:"opts.stripUnlikelyCandidates"}),"?"]})}),(0,c.jsx)("td",{children:(0,c.jsx)(t.p,{children:(0,c.jsx)(t.code,{children:"boolean"})})}),(0,c.jsx)("td",{children:(0,c.jsx)(t.p,{children:'default=true - Remove elements that match non-article-\nlike criteria first (e.g., elements with a classname of "comment").'})})]}),(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:(0,c.jsxs)(t.p,{children:[(0,c.jsx)(t.code,{children:"opts.weightNodes"}),"?"]})}),(0,c.jsx)("td",{children:(0,c.jsx)(t.p,{children:(0,c.jsx)(t.code,{children:"boolean"})})}),(0,c.jsx)("td",{children:(0,c.jsx)(t.p,{children:"default=true - Modify an element's score based on certain classNames or\nIDs (e.g., subtract if a node has a className of 'comment', add if a node has an ID of 'entry-content')."})})]})]})]}),"\n",(0,c.jsx)(t.h4,{id:"returns",children:"Returns"}),"\n",(0,c.jsx)(t.p,{children:(0,c.jsx)(t.code,{children:"string"})}),"\n",(0,c.jsx)(t.p,{children:"The extracted content as an HTML string, or null if extraction fails."}),"\n",(0,c.jsx)(t.h4,{id:"author",children:"Author"}),"\n",(0,c.jsxs)(t.p,{children:[(0,c.jsx)(t.a,{href:"https://airesearch.js.org",children:"ai-research-agent (2024)"}),"\nBased on ",(0,c.jsx)(t.a,{href:"https://github.com/postlight/parser/tree/main/src",children:"Postlight Mercury Parser (2017-)"})]}),"\n",(0,c.jsx)(t.h4,{id:"example",children:"Example"}),"\n",(0,c.jsx)(t.pre,{children:(0,c.jsx)(t.code,{className:"language-ts",children:'var url =  "https://en.wikipedia.org/wiki/David_Hilbert"\nvar html = await (await fetch(url)).text();\nvar content = extractMainContentFromHTML(html);\nconsole.log(content); // HTML content of main article body\n'})})]})}function h(e={}){let{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,c.jsx)(t,{...e,children:(0,c.jsx)(d,{...e})}):d(e)}},50065:function(e,t,n){n.d(t,{Z:function(){return a},a:function(){return s}});var r=n(67294);let c={},i=r.createContext(c);function s(e){let t=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:s(e.components),r.createElement(i.Provider,{value:t},e.children)}}}]);