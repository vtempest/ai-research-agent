"use strict";(self.webpackChunkdocusaurus_openapi_typedoc=self.webpackChunkdocusaurus_openapi_typedoc||[]).push([["4587"],{71013:function(e,n,t){t.r(n),t.d(n,{default:()=>o,frontMatter:()=>c,metadata:()=>r,assets:()=>l,toc:()=>h,contentTitle:()=>d});var r=JSON.parse('{"id":"functions/extractor/html-to-content/extract-content/extract-content-readability","title":"extract-content-readability","description":"Documentation / extractor/html-to-content/extract-content/extract-content-readability","source":"@site/docs/functions/extractor/html-to-content/extract-content/extract-content-readability.md","sourceDirName":"functions/extractor/html-to-content/extract-content","slug":"/functions/extractor/html-to-content/extract-content/extract-content-readability","permalink":"/docs/functions/extractor/html-to-content/extract-content/extract-content-readability","draft":false,"unlisted":false,"editUrl":"https://github.com/vtempest/ai-research-agent/docs/functions/extractor/html-to-content/extract-content/extract-content-readability.md","tags":[],"version":"current","frontMatter":{},"sidebar":"webapp","previous":{"title":"extract-content-mercury-utils","permalink":"/docs/functions/extractor/html-to-content/extract-content/extract-content-mercury-utils"},"next":{"title":"html-to-basic-html","permalink":"/docs/functions/extractor/html-to-content/html-to-basic-html"}}'),i=t("85893"),s=t("50065");let c={},d=void 0,l={},h=[{value:"Extract",id:"extract",level:2},{value:"extractMainContentFromHTML()",id:"extractmaincontentfromhtml",level:3},{value:"HTML-to-Main-Content Extractor #1",id:"html-to-main-content-extractor-1",level:3},{value:"Parameters",id:"parameters",level:4},{value:"Returns",id:"returns",level:4},{value:"Example",id:"example",level:4},{value:"Author",id:"author",level:4},{value:"Other",id:"other",level:2},{value:"classWeight()",id:"classweight",level:3},{value:"Parameters",id:"parameters-1",level:4},{value:"Returns",id:"returns-1",level:4},{value:"getLinkDensity()",id:"getlinkdensity",level:3},{value:"Parameters",id:"parameters-2",level:4},{value:"Returns",id:"returns-2",level:4},{value:"sanitize()",id:"sanitize",level:3},{value:"Parameters",id:"parameters-3",level:4},{value:"Returns",id:"returns-3",level:4},{value:"scoreNode()",id:"scorenode",level:3},{value:"Parameters",id:"parameters-4",level:4},{value:"Returns",id:"returns-4",level:4}];function a(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"/docs/functions/modules",children:"Documentation"})," / extractor/html-to-content/extract-content/extract-content-readability"]}),"\n",(0,i.jsx)(n.h2,{id:"extract",children:"Extract"}),"\n",(0,i.jsx)(n.h3,{id:"extractmaincontentfromhtml",children:"extractMainContentFromHTML()"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"function extractMainContentFromHTML(html: any, options?: object): Element;\n"})}),"\n",(0,i.jsx)(n.p,{children:"Defined in: extractor/html-to-content/extract-content/extract-content-readability.js:60"}),"\n",(0,i.jsx)(n.h3,{id:"html-to-main-content-extractor-1",children:"HTML-to-Main-Content Extractor #1"}),"\n",(0,i.jsx)(n.p,{children:"The function extracts main content with regex patterns, cleaning HTML, scoring nodes\nbased on content indicators like paragraphs and id/class names, selecting\nthe top candidate, extracting it, and cleaning up content around it."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Define regular expressions:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Various regex patterns are defined to identify content and non-content areas."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Define helper functions:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"normalizeSpaces: Normalizes whitespace in a string."}),"\n",(0,i.jsx)(n.li,{children:"stripTags: Removes all HTML tags from a string."}),"\n",(0,i.jsx)(n.li,{children:"getTextLength: Calculates the length of text after stripping tags."}),"\n",(0,i.jsx)(n.li,{children:"calculateLinkDensity: Calculates the ratio of link text to total text."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Clean HTML:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Remove unlikely candidates (e.g., ads, sidebars) from the HTML."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Define scoring function:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"scoreNode: Assigns a score to an HTML node based on content and attributes."}),"\n",(0,i.jsx)(n.li,{children:"Increases score for positive indicators (e.g., article, body, content tags)."}),"\n",(0,i.jsx)(n.li,{children:"Decreases score for negative indicators (e.g., hidden, footer, sidebar tags)."}),"\n",(0,i.jsx)(n.li,{children:"Adds to score based on paragraph tags and text length."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Find and score candidate nodes:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Identify potential content nodes in the cleaned HTML."}),"\n",(0,i.jsx)(n.li,{children:"Score each node using the scoreNode function."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Select top candidate:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Sort candidates by score and select the highest-scoring node."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Extract content:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use regex to extract content around the top candidate node."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Clean up extracted content:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Remove script and style tags and their contents."}),"\n",(0,i.jsx)(n.li,{children:"Process anchor tags based on content density."}),"\n",(0,i.jsx)(n.li,{children:"Keep only specific HTML tags (a, p, img, h1-h6, ul, ol, li)."}),"\n",(0,i.jsx)(n.li,{children:"Remove excess whitespace from the final content."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://trafilatura.readthedocs.io/en/latest/evaluation.html",children:"Article Extraction Benchmark"})}),"\n",(0,i.jsx)(n.h4,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Parameter"}),(0,i.jsx)("th",{children:"Type"}),(0,i.jsx)("th",{children:"Description"})]})}),(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"html"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"any"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:"\u2010"})})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"options?"})})}),(0,i.jsx)("td",{children:(0,i.jsxs)(n.p,{children:["{ ",(0,i.jsx)(n.code,{children:"minContentLength"}),": ",(0,i.jsx)(n.code,{children:"number"}),"; ",(0,i.jsx)(n.code,{children:"minScore"}),": ",(0,i.jsx)(n.code,{children:"number"}),"; ",(0,i.jsx)(n.code,{children:"minTextLength"}),": ",(0,i.jsx)(n.code,{children:"number"}),"; ",(0,i.jsx)(n.code,{children:"retryLength"}),": ",(0,i.jsx)(n.code,{children:"number"}),"; }"]})}),(0,i.jsx)("td",{})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"options.minContentLength?"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"number"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:"default=140 - Minimum length of content to be considered valid"})})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"options.minScore?"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"number"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:"default=20 - Minimum score for content to be considered valid"})})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"options.minTextLength?"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"number"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:"default=25 - Minimum length of text to be considered valid"})})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"options.retryLength?"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"number"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:"default=250 - Length to retry content extraction if initial attempt fails"})})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"returns",children:"Returns"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Element"})}),"\n",(0,i.jsx)(n.p,{children:"Extracted HTML element of main content such as article body"}),"\n",(0,i.jsx)(n.h4,{id:"example",children:"Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'var url = "https://www.nytimes.com/2024/08/28/business/telegram-ceo-pavel-durov-charged.html"\nconst html = await (await fetch(url)).text();\nvar articleContent = extractMainContentFromHTML(html);\n'})}),"\n",(0,i.jsx)(n.h4,{id:"author",children:"Author"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://airesearch.js.org",children:"ai-research-agent (2024)"}),"\nBased on ",(0,i.jsx)(n.a,{href:"https://github.com/mozilla/readability",children:"Mozilla Readability (2015)"})]}),"\n",(0,i.jsx)(n.h2,{id:"other",children:"Other"}),"\n",(0,i.jsx)(n.h3,{id:"classweight",children:"classWeight()"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"function classWeight(\n   elem: Element, \n   positiveRe: RegExp, \n   negativeRe: RegExp): number;\n"})}),"\n",(0,i.jsx)(n.p,{children:"Defined in: extractor/html-to-content/extract-content/extract-content-readability.js:249"}),"\n",(0,i.jsx)(n.p,{children:"Calculates the weight of an element based on its class and id attributes."}),"\n",(0,i.jsx)(n.h4,{id:"parameters-1",children:"Parameters"}),"\n",(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Parameter"}),(0,i.jsx)("th",{children:"Type"}),(0,i.jsx)("th",{children:"Description"})]})}),(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"elem"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Element"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:"The element to calculate weight for"})})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"positiveRe"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"RegExp"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:"Regular expression for positive indicators"})})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"negativeRe"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"RegExp"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:"Regular expression for negative indicators"})})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"returns-1",children:"Returns"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"number"})}),"\n",(0,i.jsx)(n.p,{children:"The calculated weight"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"getlinkdensity",children:"getLinkDensity()"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"function getLinkDensity(elem: Element): number;\n"})}),"\n",(0,i.jsx)(n.p,{children:"Defined in: extractor/html-to-content/extract-content/extract-content-readability.js:229"}),"\n",(0,i.jsx)(n.p,{children:"Calculates the link density of an element."}),"\n",(0,i.jsx)(n.h4,{id:"parameters-2",children:"Parameters"}),"\n",(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Parameter"}),(0,i.jsx)("th",{children:"Type"}),(0,i.jsx)("th",{children:"Description"})]})}),(0,i.jsx)("tbody",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"elem"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Element"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:"The element to calculate link density for"})})]})})]}),"\n",(0,i.jsx)(n.h4,{id:"returns-2",children:"Returns"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"number"})}),"\n",(0,i.jsx)(n.p,{children:"The link density (ratio of link text length to total text length)"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"sanitize",children:"sanitize()"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"function sanitize(\n   node: Element, \n   candidates: any, \n   videoRe: RegExp, \n   positiveRe: RegExp, \n   negativeRe: RegExp, \n   minTextLength: number): Element;\n"})}),"\n",(0,i.jsx)(n.p,{children:"Defined in: extractor/html-to-content/extract-content/extract-content-readability.js:317"}),"\n",(0,i.jsx)(n.p,{children:"Sanitizes the content by removing unwanted elements and cleaning remaining elements."}),"\n",(0,i.jsx)(n.h4,{id:"parameters-3",children:"Parameters"}),"\n",(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Parameter"}),(0,i.jsx)("th",{children:"Type"}),(0,i.jsx)("th",{children:"Description"})]})}),(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"node"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Element"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:"The node to sanitize"})})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"candidates"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"any"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:"Object containing scored candidates"})})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"videoRe"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"RegExp"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:"Regular expression for video URLs"})})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"positiveRe"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"RegExp"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:"Regular expression for positive indicators"})})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"negativeRe"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"RegExp"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:"Regular expression for negative indicators"})})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"minTextLength"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"number"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:"Minimum text length to consider"})})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"returns-3",children:"Returns"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Element"})}),"\n",(0,i.jsx)(n.p,{children:"The sanitized node"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"scorenode",children:"scoreNode()"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"function scoreNode(\n   elem: Element, \n   positiveRe: RegExp, \n   negativeRe: RegExp): any;\n"})}),"\n",(0,i.jsx)(n.p,{children:"Defined in: extractor/html-to-content/extract-content/extract-content-readability.js:270"}),"\n",(0,i.jsx)(n.p,{children:"Scores a node based on its tag name and attributes."}),"\n",(0,i.jsx)(n.h4,{id:"parameters-4",children:"Parameters"}),"\n",(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Parameter"}),(0,i.jsx)("th",{children:"Type"}),(0,i.jsx)("th",{children:"Description"})]})}),(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"elem"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Element"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:"The element to score"})})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"positiveRe"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"RegExp"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:"Regular expression for positive indicators"})})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"negativeRe"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"RegExp"})})}),(0,i.jsx)("td",{children:(0,i.jsx)(n.p,{children:"Regular expression for negative indicators"})})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"returns-4",children:"Returns"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"any"})}),"\n",(0,i.jsx)(n.p,{children:"An object containing the score and the element"})]})}function o(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},50065:function(e,n,t){t.d(n,{Z:function(){return d},a:function(){return c}});var r=t(67294);let i={},s=r.createContext(i);function c(e){let n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);