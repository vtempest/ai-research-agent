!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["api-client"]={})}(this,function(e){"use strict";var t=async(e,t)=>{let r="function"==typeof t?await t(e):t;if(r)return"bearer"===e.scheme?`Bearer ${r}`:"basic"===e.scheme?`Basic ${btoa(r)}`:r},r={bodySerializer:e=>JSON.stringify(e,(e,t)=>"bigint"==typeof t?t.toString():t)},a=({allowReserved:e,explode:t,name:r,style:a,value:n})=>{if(!t){let t=(e?n:n.map(e=>encodeURIComponent(e))).join((e=>{switch(e){case"form":default:return",";case"pipeDelimited":return"|";case"spaceDelimited":return"%20"}})(a));switch(a){case"label":return`.${t}`;case"matrix":return`;${r}=${t}`;case"simple":return t;default:return`${r}=${t}`}}let l=(e=>{switch(e){case"label":return".";case"matrix":return";";case"simple":return",";default:return"&"}})(a),o=n.map(t=>"label"===a||"simple"===a?e?t:encodeURIComponent(t):s({allowReserved:e,name:r,value:t})).join(l);return"label"===a||"matrix"===a?l+o:o},s=({allowReserved:e,name:t,value:r})=>{if(null==r)return"";if("object"==typeof r)throw new Error("Deeply-nested arrays/objects arenâ€™t supported. Provide your own `querySerializer()` to handle these.");return`${t}=${e?r:encodeURIComponent(r)}`},n=({allowReserved:e,explode:t,name:r,style:a,value:n})=>{if(n instanceof Date)return`${r}=${n.toISOString()}`;if("deepObject"!==a&&!t){let t=[];Object.entries(n).forEach(([r,a])=>{t=[...t,r,e?a:encodeURIComponent(a)]});let s=t.join(",");switch(a){case"form":return`${r}=${s}`;case"label":return`.${s}`;case"matrix":return`;${r}=${s}`;default:return s}}let l=(e=>{switch(e){case"label":return".";case"matrix":return";";case"simple":return",";default:return"&"}})(a),o=Object.entries(n).map(([t,n])=>s({allowReserved:e,name:"deepObject"===a?`${r}[${t}]`:t,value:n})).join(l);return"label"===a||"matrix"===a?l+o:o},l=/\{[^{}]+\}/g,o=({allowReserved:e,array:t,object:r}={})=>l=>{let o=[];if(l&&"object"==typeof l)for(let i in l){let u=l[i];if(null!=u)if(Array.isArray(u)){let r=a({allowReserved:e,explode:!0,name:i,style:"form",value:u,...t});r&&o.push(r)}else if("object"==typeof u){let t=n({allowReserved:e,explode:!0,name:i,style:"deepObject",value:u,...r});t&&o.push(t)}else{let t=s({allowReserved:e,name:i,value:u});t&&o.push(t)}}return o.join("&")},i=e=>u({baseUrl:e.baseUrl,path:e.path,query:e.query,querySerializer:"function"==typeof e.querySerializer?e.querySerializer:o(e.querySerializer),url:e.url}),u=({baseUrl:e,path:t,query:r,querySerializer:o,url:i})=>{let u=(e??"")+(i.startsWith("/")?i:`/${i}`);t&&(u=(({path:e,url:t})=>{let r=t,o=t.match(l);if(o)for(let l of o){let t=!1,o=l.substring(1,l.length-1),i="simple";o.endsWith("*")&&(t=!0,o=o.substring(0,o.length-1)),o.startsWith(".")?(o=o.substring(1),i="label"):o.startsWith(";")&&(o=o.substring(1),i="matrix");let u=e[o];if(null==u)continue;if(Array.isArray(u)){r=r.replace(l,a({explode:t,name:o,style:i,value:u}));continue}if("object"==typeof u){r=r.replace(l,n({explode:t,name:o,style:i,value:u}));continue}if("matrix"===i){r=r.replace(l,`;${s({name:o,value:u})}`);continue}let d=encodeURIComponent("label"===i?`.${u}`:u);r=r.replace(l,d)}return r})({path:t,url:u}));let d=r?o(r):"";return d.startsWith("?")&&(d=d.substring(1)),d&&(u+=`?${d}`),u},d=(e,t)=>{let r={...e,...t};return r.baseUrl?.endsWith("/")&&(r.baseUrl=r.baseUrl.substring(0,r.baseUrl.length-1)),r.headers=f(e.headers,t.headers),r},f=(...e)=>{let t=new Headers;for(let r of e){if(!r||"object"!=typeof r)continue;let e=r instanceof Headers?r.entries():Object.entries(r);for(let[r,a]of e)if(null===a)t.delete(r);else if(Array.isArray(a))for(let e of a)t.append(r,e);else void 0!==a&&t.set(r,"object"==typeof a?JSON.stringify(a):a)}return t},c=class{_fns;constructor(){this._fns=[]}clear(){this._fns=[]}getInterceptorIndex(e){return"number"==typeof e?this._fns[e]?e:-1:this._fns.indexOf(e)}exists(e){let t=this.getInterceptorIndex(e);return!!this._fns[t]}eject(e){let t=this.getInterceptorIndex(e);this._fns[t]&&(this._fns[t]=null)}update(e,t){let r=this.getInterceptorIndex(e);return!!this._fns[r]&&(this._fns[r]=t,e)}use(e){return this._fns=[...this._fns,e],this._fns.length-1}},p=o({allowReserved:!1,array:{explode:!0,style:"form"},object:{explode:!0,style:"deepObject"}}),h={"Content-Type":"application/json"},y=(e={})=>({...r,headers:h,parseAs:"auto",querySerializer:p,...e});const b=((e={})=>{let r=d(y(),e),a=()=>({...r}),s={error:new c,request:new c,response:new c},n=async e=>{let a={...r,...e,fetch:e.fetch??r.fetch??globalThis.fetch,headers:f(r.headers,e.headers)};a.security&&await(async({security:e,...r})=>{for(let a of e){let e=await t(a,r.auth);if(!e)continue;let s=a.name??"Authorization";switch(a.in){case"query":r.query||(r.query={}),r.query[s]=e;break;case"cookie":r.headers.append("Cookie",`${s}=${e}`);break;default:r.headers.set(s,e)}return}})({...a,security:a.security}),a.body&&a.bodySerializer&&(a.body=a.bodySerializer(a.body)),(void 0===a.body||""===a.body)&&a.headers.delete("Content-Type");let n=i(a),l={redirect:"follow",...a},o=new Request(n,l);for(let t of s.request._fns)t&&(o=await t(o,a));let u=a.fetch,d=await u(o);for(let t of s.response._fns)t&&(d=await t(d,o,a));let c={request:o,response:d};if(d.ok){if(204===d.status||"0"===d.headers.get("Content-Length"))return"data"===a.responseStyle?{}:{data:{},...c};let e=("auto"===a.parseAs?(e=>{if(!e)return"stream";let t=e.split(";")[0]?.trim();if(t){if(t.startsWith("application/json")||t.endsWith("+json"))return"json";if("multipart/form-data"===t)return"formData";if(["application/","audio/","image/","video/"].some(e=>t.startsWith(e)))return"blob";if(t.startsWith("text/"))return"text"}})(d.headers.get("Content-Type")):a.parseAs)??"json";if("stream"===e)return"data"===a.responseStyle?d.body:{data:d.body,...c};let t=await d[e]();return"json"===e&&(a.responseValidator&&await a.responseValidator(t),a.responseTransformer&&(t=await a.responseTransformer(t))),"data"===a.responseStyle?t:{data:t,...c}}let p=await d.text();try{p=JSON.parse(p)}catch{}let h=p;for(let t of s.error._fns)t&&(h=await t(p,d,o,a));if(h=h||{},a.throwOnError)throw h;return"data"===a.responseStyle?void 0:{error:h,...c}};return{buildUrl:i,connect:e=>n({...e,method:"CONNECT"}),delete:e=>n({...e,method:"DELETE"}),get:e=>n({...e,method:"GET"}),getConfig:a,head:e=>n({...e,method:"HEAD"}),interceptors:s,options:e=>n({...e,method:"OPTIONS"}),patch:e=>n({...e,method:"PATCH"}),post:e=>n({...e,method:"POST"}),put:e=>n({...e,method:"PUT"}),request:n,setConfig:e=>(r=d(r,e),a()),trace:e=>n({...e,method:"TRACE"})}})((m=y(),{...m,baseUrl:m.baseUrl}));var m;e.extractContent=e=>(e.client??b).get({url:"/extract",...e}),e.searchWeb=e=>(e.client??b).get({url:"/search",...e}),e.writeLanguage=e=>(e.client??b).post({url:"/agents",...e,headers:{"Content-Type":"application/json",...e.headers}}),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});
